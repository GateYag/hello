#include <iostream>
#include <string.h>
using namespace std;
#define MAXNUM (int)1e7+5
int c[MAXNUM]; int b[1000005];
int cnt; int rnt; int ant;

void logIn(int a, int code) {
	if (c[a] == 0) {
		cnt++; b[rnt++] = a;
		}
	c[a] = code + 1;
}

void logOut(int a) { if (c[a] != 0) { c[a] = 0; cnt--; } }
void close() { for (int i=0;i<rnt;i++)c[b[i]] = 0;
cnt = 0; rnt = 0;
 }
int Num() { return cnt; }
int query(int a) { return c[a]-1; }

int main()
{
	ios_base::sync_with_stdio(0); cin.tie(0), cout.tie(0);
	int n, m, num, code; long long sum = 0;
	cin >> n >> m;
	char s=' ';
	while (m-->0)
	{
		cin >> s;
		switch (s)
		{
			case 'I':cin >> num >> code;
				logIn(num, code); break;
			case 'Q':cin >> num;
				sum+=query(num); break;
			case 'C':close(); break;
			case 'N':
				sum += Num(); break;
			case 'O':cin >> num;
				logOut(num); break;
		default:
			break;
		}
	}
    std::cout << sum; 
}

